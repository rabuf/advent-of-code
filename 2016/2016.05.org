#+STARTUP: indent contents
#+OPTIONS: num:nil toc:nil
* Day 05
** Executing this code
If you have a lisp installation, emacs, org-mode, and org-babel
support for lisp installed you can run this by:
1. Starting slime (=M-x slime=)
2. Typing =C-c C-c= in the block [[initialize][initialize]].
3. In the repl type =(in-package :aoc-2016-05)=
4. Typing =C-c C-c= in the block [[answers][answers]]
** Initial stuffs
*** Packages to load
#+NAME: packages
#+BEGIN_SRC lisp :results silent
  (unless (find-package :cl-ppcre)
    (ql:quickload "cl-ppcre"))
  (unless (find-package :iterate)
    (ql:quickload "iterate"))
  (unless (find-package :parseq)
    (ql:quickload "parseq"))
  (unless (find-package :fiveam)
    (ql:quickload "fiveam"))
  (unless (find-package :series)
    (ql:quickload "series"))
  (unless (find-package :cl-permutation)
    (ql:quickload "cl-permutation"))
  (unless (find-package :bordeaux-threads)
    (ql:quickload "bordeaux-threads"))
#+END_SRC
*** Create package for this day
#+NAME: initialize
#+BEGIN_SRC lisp :noweb yes :results silent
  <<packages>>
  (defpackage :aoc-2016-05
    (:use :common-lisp
          :iterate
          :parseq
          :fiveam)
    (:export :problem-a
             :problem-b))
  (in-package :aoc-2016-05)
  (require :sb-md5)
#+END_SRC
** Input
Today's input is a fixed string.
#+NAME: input
#+BEGIN_SRC lisp :noweb yes :results silent
  (defparameter *input* "cxdnnyjw")
#+END_SRC
** Part 1
The challenge is to find the first 8 cases where the MD5 checksum of
the string + a number (starting at 0, appended to the string) starts
with 5 0s.

This solution takes about a minute on my laptop.
#+NAME: interesting-hash-p
#+BEGIN_SRC lisp :noweb yes :results silent
  (defun interesting-hash-p (hash)
      (string= "00000" (subseq hash 0 5)))
#+END_SRC
#+NAME: solve-a
#+BEGIN_SRC lisp :noweb yes :results silent
  (defun hash (string number)
    (format nil "铂О佝ㄣ镥蜚筲礓岛礓刁蹴篝蜷铉ㄦ矧磲铋窿立篝蜷铉铛礅弪┅ъ轶舂┅ㄤ彐躅箫祧瀛篝蜷铉ㄩ翦ㄦ矧骝镯癌ㄦ矧栳箬ㄨ狍篝蜷铉椹鏖翳泔躅癌躅糸泔躅舂ㄦ轭犰禊蝈趱蝾ㄣ镥蜚疳篌黠蜾篝蜷铉┅麒孱ㄩ铘弪弩糸铉栳箬栳箬ㄩ钽泔躅舂ㄣ镬戾泗ㄣ栳栳箬旦轭麸疳篌黠蜾┅┅＋盼倪右＋瘟团痱镡戾憝＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘ㄤ彐躅痱镡戾憝īㄦ矧磲⑿蝻忪屙暗梁狺ア箫祧瀛轭瘐舄┅＋盼倪右嗅螋族祆翳轶鏖祆忮轭翦蝈篝轭绠澡肤汨狎徙翦轶铒翳疳篌泔溴汨狎徙翦颥犷轸痫箝糸镱轶溴翦蝽轭邃怡翳遏璁澡骈蝮糸礤痫箝糸镱轶骘躅轸箬秕熹忮骈祆邃犰灬翦轭篝犷沐殓铒蝈洚澡疳篌黠蜾轶骘躅麒孱犰痫箝糸镱狎骘躅洚＋瘟团箫祧瀛＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘ㄤ彐躅疳篌黠蜾麸篝蜷铉疳篌黠蜾ㄩ翦ㄦ矧骝镯麸珐鏖翳疳篌磲脲篝蜷铉洪铋糸犰屐屙孱＼擤麒孱ㄧ弭栳箬疳篌黠蜾箦翩ㄣ栳疳篌椹ㄧ弭栳箬疳篌黠蜾┅ㄦ轭犰禊蝈趱蝾疳篌┅┅ㄤ彐躅箫祧瀛篝蜷铉ㄩ翦ㄦ矧骝镯癌ㄦ矧栳箬ㄨ狍篝蜷铉椹鏖翳疳篌黠蜾磲脲栳箬翎忪濠ㄦ矧痫箝糸镱ōㄣ栳颦泔溴ㄣ栳栳箬旦ㄣ栳颦泔溴＼癌┅ㄦ矧鲠祯ㄣ栳栳箬订躅糸ㄨ狍璀翎忪瀛泔躅疳篌黠蜾┅ㄦ轭犰禊蝈趱蝾疳篌黠蜾麸篝蜷铉疳篌黠蜾┅麒孱ㄡ钿冀痫箝糸镱珐铒ㄧ弭栳箬痫箝糸镱疳篌黠蜾┅ㄩ铘弪弩糸铉栳箬栳箬┅箦翩ㄧ弭栳箬痫箝糸镱疳篌黠蜾鲠祯濠痱轭疳篌黠蜾麸篝蜷铉疳篌黠蜾┅┅＋盼倪右羚衢瞵翳轶轶鲥蝙箪秣篚箴邈轸翳麽骚泔铞弪糸铉遽汨礓汨邈塍蹴轭麸篝蜷铉深舶钡翳弪濮犷雉桢颥箝黹灬颥痱镡戾犷麽徕戾麸栳钿戾徕秕爆鞍艾鞍汨邈塍蹴疱箦泔钿箫翳轶蝈犰禊箬秕熹忮祜驷篝弪滹瞌驽屐扉脲镳糸黹轭翳轶镱瀣怩骚祆祜镫轭麸轸殒犷雉桢湍汨邈塍蹴痱镡戾泔礤躔＋瘟团痱镡戾憝＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘ㄤ彐躅痱镡戾憝īㄦ矧磲⑿蝻忪屙暗潞狺ア箫祧瀛轭瘐舄┅＋盼倪右絮趑轭轸犰麸珏翳弪＋瘟团篝蝓泗＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘＋盼倪右＋瘟团骢钽糸镱＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘技蝈徜轭瘐艟技轭瘐艟技轭翦蝈篝轭绛栳箬揪技箫祧瀛峋技箫祧瀛饩＋盼倪右＋瘟团犷篦弪＋屡巧芜右扉箴候弩蹯趔秕麴豸哄痫螋怙翳侯秣邂弩呼犷珈舶倍暗扉箴技轭轸獒扉寰技篝蝓泗缶技骢钽糸镱缶技轭瘐艟技痱镡戾憝峋技痱镡戾憝饩痱镡戾憝岍痱镡戾憝猢＋盼倪右令篦弪＋遗诱淘雍犷篦弪＋忮玳钸屮犴痨序镡戾暗梁品妨芭杜⑦哌哌哌芒⒐哌哌哌芒⒐哌哌吲芒⒐哌卟吲芒⒐吖卟吲芒⒐吖覆吲芒⒐吖覆概芒⒐构覆概芒序镡戾暗潞构垢哺琶＋孱溥屮犴痨藻篝冕箦＋瘟团翦篝汜箦＋屡巧芜右扉箴候弩蹯趔秕麴豸哄痫螋怙翳ㄤ彐篚轸犸惝舶倍暗ㄩ瞽篚轸犸惝舶倍暗蝓睢п镢舶倍暗＋盼倪右藻篝义篚祠＋遗诱淘雍翦篝汜箦澡秕玷趔