#+STARTUP: indent contents
#+OPTIONS: num:nil toc:nil
* Day 23
** Executing this code
If you have a lisp installation, emacs, org-mode, and org-babel
support for lisp installed you can run this by:
1. Starting slime (=M-x slime=)
2. Typing =C-c C-c= in the block [[initialize][initialize]].
3. In the repl type =(in-package :aoc-2020-23)=
4. Typing =C-c C-c= in the block [[answers][answers]]
** Initial stuffs
*** Packages to load
#+NAME: packages
#+BEGIN_SRC lisp :results silent
  (unless (find-package :cl-ppcre)
    (ql:quickload "cl-ppcre"))
  (unless (find-package :iterate)
    (ql:quickload "iterate"))
  (unless (find-package :parseq)
    (ql:quickload "parseq"))
  (unless (find-package :fiveam)
    (ql:quickload "fiveam"))
  (unless (find-package :series)
    (ql:quickload "series"))
  (unless (find-package :cl-permutation)
    (ql:quickload "cl-permutation"))
  (unless (find-package :bordeaux-threads)
    (ql:quickload "bordeaux-threads"))
#+END_SRC
*** Create package for this day
#+NAME: initialize
#+BEGIN_SRC lisp :noweb yes :results silent
  <<packages>>
  (defpackage :aoc-2020-23
    (:use :common-lisp
          :iterate
          :parseq
          :fiveam)
    (:export :problem-a
             :problem-b))
  (in-package :aoc-2020-23)
#+END_SRC
** Input
Just a number, no parsing! That's a lie, it needs to be interpreted as
a set of cups each given a unique number. I'll deal with that in part 1.
#+NAME: input
#+BEGIN_SRC lisp :noweb yes :results silent
  (defparameter *input* 916438275)
#+END_SRC
** Part 1
Given a set of cups (given with an identifier unique to each) perform
a move. From the current cup, pick up the next three. Place them to
the right of the cup one less than the current cup (keep decrementing
if this one was picked up). Then the next cup is the one right of the
current cup.
#+NAME: move
#+BEGIN_SRC lisp :results silent
  (defun move (cups)
    "Performa a MOVE on the cups, the current cup is always first in the list."
    (let* ((curr (pop cups))
           (next (subseq cups 0 3))
           (destination (1- curr)))
      (setf cups (subseq cups 3))
      (loop while (or (< destination 1) (member destination next))
         do (decf destination)
           (when (< destination 1)
             (setf destination 9)))
      (let ((left (subseq cups 0 (1+ (position destination cups))))
            (right (subseq cups (1+ (position destination cups)))))
        (append left next right (list curr)))))
#+END_SRC
#+NAME: cups
#+BEGIN_SRC lisp :results silent :noweb yes
  <<move>>
  (defun cups (number &optional (times 100))
    (let ((cups (loop for n = number then (floor n 10)
                   until (zerop n)
                   collect (mod n 10) into result
                   finally (return (reverse result)))))
      (loop
         for i from 1 to times
         do
           (setf cups (move cups)))
      (format nil "窿窿篚怏羼沲痼ū痫箝糸镱沲痼┅篚怏羼沲痼痫箝糸镱沲痼┅┅＋盼倪右＋瘟团痱镡戾憝＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘ㄤ彐躅痱镡戾憝īㄦ矧磲⑿蝻忪屙渤梁狺アㄦ狍舡沲痼轭瘐舄卑癌┅＋盼倪右嗅螋骚顼轭麸屐轫轭狒犰盹鲥礤铘深篝遽骚顼轭麸栳鲥犷狎蜥麒弪遽汨轭溴轶沲瓞犷翳鲠祯轶翳铄舄沲甬深篝遽镦盹鲩铉鲠祯弩盹鲥鏖祆蝈篚祠轭描犷珏沲蝌孱沲麸痫轭麸沲徼遽ㄡ骠弪翳盹鲥沲痼描犷珏溴篝轭狒轱麸痫轭麸骈蝮沲轭盹鲥沲痼描犷珏灬篝盹鲥沲麸痫轭麸徭翦翳矧殓轭犰溴篝轭狒轱鲠祯澡弩狎蝈犰禊牾篝篦狃蟋箫汜滹翳轶躞轭金箦翩轭镱屮痱弩箝镱＋瘟团驷篝沲痼＋屡巧芜右扉箴候弩蹯趔箝戾铘侯秣邂弩ㄤ彐躅磲脲沲瓠狎蜥铛礅弪麸翎飙沲痼戾è沲痼祜镳骘铛礅弪翳孱ㄦ祜矧卑躅糸弪镳瞟泔祆邈盹卑轭麸蝈篚祠骈钺祆蝈趱蝾蝈鲥蝮蝈篚祠┅┅箦翩沲痼ㄡ痧孱沲痼祜镳骘骝镯ūㄡ痧禊＇磲沲痼┅麸麸翎飙沲痼泔祆邈椹扉篝ㄦ轵篝沲痼┅┅戾è狎蜥磲脲狎蜥ū麸翎飙沲痼┅┅祜镳骘轭沲痼骘轭ㄣ潋沲痼滹箦翩ㄡ蝈狎蜥椹戛扉篝ㄦ轵篝沲痼狎蜥┅┅ㄤ彐躅驷篝盹鲥ㄣ躜蝈铘沲痼磲泸镬弭è铄舡沲ㄩ啜狎彐沲痼椹┅戾舄è溴篝轭狒轱ū沲蝌孱舂铄铄舡沲铄舡沲铄舡沲铄舡沲沲蝌孱舂┅┅盹鲥桢徜铄舡沲沲蝌孱舂盹鲥翎殪铄舡沲铄舡沲盹鲥桢徜┅┅祜镳麒殪矧溴篝轭狒轱暴礤礅弪溴篝轭狒轱扉篝盹鲥桢徜铄舡沲盹鲥桢徜盹鲥翎殪┅滹ㄤ邈溴篝轭狒轱瞟麒孱溴篝轭狒轱暴箦翩溴篝轭狒轱ūㄡ蝌狴溟礤铙轱沲痼癌┅┅痼弭铄舡沲沲蝌孱舂铄铄舡沲溴篝轭狒轱瞟盹鲥桢徜铄舡沲盹鲥翎殪铄舡沲溴篝轭狒轱瞟┅┅ㄤ彐躅驷篝沲痼箦邃麸翎飙沲痼轸弪狒轱铙ㄤ弩趄蹉趱蜷铉忾钿ㄣ躜蝈铘沲痼磲脲沲瓠狎蜥箦邃麸翎飙沲痼祜镳骘骝镯麸轸弪狒轱铙滹ㄦ狍舡盹鲥沲蝌孱沲痼箦翩沲蝌孱ㄡ蝈沲痼沲蝌孱舂┅鲠祯弩ㄦ矧磲铋窿祜镳蝈疱狒骘ㄡ蝈沲痼暴翳孱ㄡ蝈沲痼椹泔祆邈椹íㄡ蝈沲痼暴ㄡ蝈沲痼ㄡ蝈沲痼暴┅┅＋盼倪右＋瘟团痱镡戾憝＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘ㄤ彐躅痱镡戾憝īㄦ矧磲⑿蝻忪屙渤潞狺ア铘璀鲠祯ㄦ狍舡沲痼轭瘐舄卑鞍鞍卑鞍鞍鞍┅┅＋盼倪右絮趑轭轸犰麸珏翳弪＋瘟团篝蝓泗＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘＋盼倪右＋瘟团骢钽糸镱＋屡巧芜右扉箴侯秣邂弩候弩蹯趔箝戾铘技轭瘐艟技沲痼揪技驷篝沲痼揪＋盼倪右＋瘟团犷篦弪＋屡巧芜右扉箴候弩蹯趔秕麴豸哄痫螋怙翳侯秣邂弩呼犷珈铒技轭轸獒扉寰技篝蝓泗缶技骢钽糸镱缶技轭瘐艟技痱镡戾憝峋技痱镡戾憝饩痱镡戾憝岍痱镡戾憝猢＋盼倪右令篦弪＋遗诱淘雍犷篦弪序镡戾渤梁彻刀床阜序镡戾渤潞窗创潮肮豆创藻篝冕箦＋瘟团翦篝汜箦＋屡巧芜右扉箴候弩蹯趔秕麴豸哄痫螋怙翳ㄤ彐篚轸犸惝舶舶渤ㄩ瞽篚轸犸惝舶舶渤蝓睢п镢舶舶渤＋盼倪右藻篝义篚祠＋遗诱淘雍翦篝汜箦澡秕玷趔龄阴铑弪娱眇戾蝓铑弪＋屡巧芜右徜呼犷珈徜岑溽渤徜鏖翳料貌安爱尼渤痱镢邃躜尼渤轶忮玳料貌安爱尼渤阴罨孱尼渤＋盼倪右羽邈殒殂狒轱羽邈殒殂狒轱骘箫祯糸镱＋屡巧芜右徜呼犷珈徜岑犸悴安碍溽渤徜疳汶徵料貌安爱尼渤轶痱镢邃躜阴罨孱料貌安爱尼渤＋盼倪右嗅汶徵弩＋瘟团徜岘疳汶徵弩＋屡巧芜右徜鏖翳俏猎义琊狒躞俏猎义琊狒鏖翳藻暨上躞藻暨上＋盼倪右赠疱犷珏铄蜷泱＋瘟团豉疱蟓犷洵珏铄蜷泱＋屡巧芜右徜＋盼倪右身痨屙孱翎糸镱零趱犰轫痨屙孱翎糸镱怙澌＋屡巧芜右徜呼犷珈徜岑犸悴安碍溽渤徜技徜岘疳汶徵弩揪疳汶徵怙澌料貌安爱尼渤轶技豉疱蟓犷洵珏铄蜷泱揪阵邃狍犷屮犴痨镦磲翥栝铉蝈珲灬屮痱弩箝镱痱镢邃躜嗅蝮暹涕铄ㄌ轭疹怙躅溴溥郁蜷铉秕嗅篌黠蜾轶嗅趑弪泔铙翎铘郁蜷铉航ㄜ浍┉ㄜ浍ㄛ岘荸ㄛ岘莴⒒义泔铙翎铘嗅趑弪钸歪翥桢航蔑眇殪濞嗅趑弪瞟歪翥桢歪翥柽硫蜥ò穿嗅篌疹怙躅溴溥郁蜷铉邪斜酗箝糸鲥描狎徙翦蚧忮玳歪翥瑷义燥哂趄轭绋涕铄┈歪翥桢螬邪航深翦珏颛轴祯濞屿殂濞涕铄歪翥桢蟥暴崎蝮衄歪翥桢蟥暴提篝┅斜航深翦珏颛轴祯濞屿殂濞涕铄歪翥桢蟥博崎蝮衄歪翥桢蟥博提篝┅航澎屙孱舁涕铄歪翥桢蟥畅崎蝮舂嗅篌航燥哒钼秕钿邃哂趄轭绋屿殂濞涕铄歪翥桢蟥穿崎蝮衄歪翥桢蟥穿提篝┅航ㄍ轭呦蜻酗骄邪歪呦蜻酗骄斜骄矛骄嗅篌┗孱嗅蝮暹涕铄痱镢邃躜阴轶忮玳絮暨涕铄á龄鲥铘镦蔑溴舶舶尼渤┗絮暨涕铄á澡蝈篚祠骘嗅螋轶深翦珏颛身徵濞癌┗絮暨涕铄á澡蝈篚祠骘嗅螋轶深翦珏颛身徵濞癌┗孱阴罨孱料貌安爱尼渤＋盼倪右阴翳痱镧蜥深矧溴麸蝓翳轶秕栳鲥麸Ⅳ犷珈澧翳泔溴骈蝮躞轭矫铆铆艚＋屡巧芜右箬屐呼犷珈铒候弩蹯趔秕麴豸哄痫螋怙翳沅徜珙狒磲脲溽渤溽渤＋盼倪右＋遗诱淘雍